# –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã API –¥–ª—è Tomilo Lib Server

## –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

–í—Å–µ API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–ª–µ–¥—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.

## –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ API

–í—Å–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç API —Å–ª–µ–¥—É—é—ÇÁªü‰∏Ä–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É:

```typescript
interface ApiResponseDto<T> {
  success: boolean;
  data?: T;
  message?: string;
  errors?: string[];
  timestamp: string;
  path: string;
  method?: string;
}
```

### –ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞:

- `success`: boolean - —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ (true/false)
- `data`: T (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞
- `message`: string (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `errors`: string[] (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ
- `timestamp`: string - –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO 8601
- `path`: string - –ø—É—Ç—å –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç—É
- `method`: string (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - HTTP –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞

### –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤:

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "data": {
    "id": "123",
    "title": "–ü—Ä–∏–º–µ—Ä —Ç–∞–π—Ç–ª–∞"
  },
  "message": "Title fetched successfully",
  "timestamp": "2023-01-01T12:00:00.000Z",
  "path": "titles/123",
  "method": "GET"
}
```

#### –û—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π:
```json
{
  "success": false,
  "message": "Failed to fetch title",
  "errors": ["Title not found"],
  "timestamp": "2023-01-01T12:00:00.000Z",
  "path": "titles/123"
}
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤

–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—â–∏–π interceptor `FileUploadInterceptor`.

### –û–¥–∏–Ω–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã:
```typescript
@UseInterceptors(
  FileUploadInterceptor.create('fieldName', {
    destination: './uploads/path',
    fileTypes: /\/(jpg|jpeg|png|webp)$/,
    fileSize: 5 * 1024 * 1024, // 5MB
    filenamePrefix: 'prefix',
  }),
)
```

### –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
```typescript
@UseInterceptors(
  FileUploadInterceptor.createMultiple('fieldName', {
    destination: './uploads/path',
    fileTypes: /\/(jpg|jpeg|png|webp)$/,
    fileSize: 5 * 1024 * 1024, // 5MB
    filenamePrefix: 'prefix',
    maxFiles: 10,
  }),
)
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä `HttpExceptionFilter`, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ –≤Áªü‰∏Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç API.

## –í–∞–ª–∏–¥–∞—Ü–∏—è

–ì–ª–æ–±–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ —á–µ—Ä–µ–∑ `ValidationPipe` –≤ `main.ts`.

## –û–±—â–∏–µ DTO

### ApiResponseDto
```typescript
class ApiResponseDto<T> {
  success: boolean;
  data?: T;
  message?: string;
  errors?: string[];
  timestamp: string;
  path: string;
  method?: string;
}
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

1. –í—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ApiResponseDto` –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤
2. –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `FileUploadInterceptor`
3. –í—Å–µ –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ try/catch —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º `ApiResponseDto`
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã NestJS –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. –°–ª–µ–¥–æ–≤–∞—Ç—å RESTful –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ auth/          # –ú–æ–¥—É–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ chapters/      # –ú–æ–¥—É–ª—å –≥–ª–∞–≤
‚îú‚îÄ‚îÄ common/        # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (interceptors, filters, DTOs)
‚îú‚îÄ‚îÄ files/         # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
‚îú‚îÄ‚îÄ search/        # –ú–æ–¥—É–ª—å –ø–æ–∏—Å–∫–∞
‚îú‚îÄ‚îÄ titles/        # –ú–æ–¥—É–ª—å —Ç–∞–π—Ç–ª–æ–≤
‚îú‚îÄ‚îÄ users/         # –ú–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ app.module.ts  # –ö–æ—Ä–Ω–µ–≤–æ–π –º–æ–¥—É–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ main.ts        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```
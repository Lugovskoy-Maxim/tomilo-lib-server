# Tomilo Lib Server

Tomilo Lib Server - —ç—Ç–æ backend –¥–ª—è –æ–Ω–ª–∞–π–Ω-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º–∞–Ω–≥–∏, –∫–æ–º–∏–∫—Å–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∑–∞–∫–ª–∞–¥–∫–∞–º–∏, –∏—Å—Ç–æ—Ä–∏–µ–π —á—Ç–µ–Ω–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Backend**: NestJS, TypeScript
- **Database**: MongoDB —Å Mongoose
- **Authentication**: JWT, OAuth (Yandex, VK), bcrypt
- **File Upload**: Multer
- **Validation**: class-validator, class-transformer
- **Real-time**: WebSocket (Socket.IO)
- **Scheduling**: @nestjs/schedule
- **Logging**: Winston

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (JWT, OAuth —á–µ—Ä–µ–∑ Yandex –∏ VK)
- –ü—Ä–æ—Ñ–∏–ª—å —Å –∞–≤–∞—Ç–∞—Ä–æ–º, –∑–∞–∫–ª–∞–¥–∫–∞–º–∏ –∏ –∏—Å—Ç–æ—Ä–∏–µ–π —á—Ç–µ–Ω–∏—è
- –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á—Ç–µ–Ω–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### üìö –¢–∞–π—Ç–ª—ã (–ú–∞–Ω–≥–∞/–ö–æ–º–∏–∫—Å—ã)
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–π—Ç–ª–æ–≤
- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∂–∞–Ω—Ä–∞–º, —Å—Ç–∞—Ç—É—Å—É, —Ç–∏–ø—É
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- –†–µ–π—Ç–∏–Ω–≥–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –û–±–ª–æ–∂–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è

### üìñ –ì–ª–∞–≤—ã
- –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É –≥–ª–∞–≤–∞–º–∏ (—Å–ª–µ–¥—É—é—â–∞—è/–ø—Ä–µ–¥—ã–¥—É—â–∞—è)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –≥–ª–∞–≤ –≤ —Ç–∞–π—Ç–ª–∞—Ö
- –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≥–ª–∞–≤

### üîñ –ó–∞–∫–ª–∞–¥–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–ª–∞–¥–æ–∫
- –ò—Å—Ç–æ—Ä–∏—è —á—Ç–µ–Ω–∏—è —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —á—Ç–µ–Ω–∏—è

### üîç –ü–æ–∏—Å–∫ –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- –ü–æ–∏—Å–∫ —Ç–∞–π—Ç–ª–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ –æ–ø–∏—Å–∞–Ω–∏—é
- –ö–æ–ª–ª–µ–∫—Ü–∏–∏ —Ç–∞–π—Ç–ª–æ–≤ —Å –æ–±–ª–æ–∂–∫–∞–º–∏
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥
- –ò–º–ø–æ—Ä—Ç —Ç–∞–π—Ç–ª–æ–≤ –∏ –≥–ª–∞–≤ —Å –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∞–π—Ç–æ–≤-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Ç–∞–π—Ç–ª–∞–º –∏ –≥–ª–∞–≤–∞–º
- –õ–∞–π–∫–∏/–¥–∏–∑–ª–∞–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–æ—Ç–≤–µ—Ç—ã)

### üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ú–∞—Å—Å–æ–≤–∞—è –æ—Ç–º–µ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö

## üìä API Endpoints

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö API endpoints –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Ñ–∞–π–ª–µ [API_ENDPOINTS.md](API_ENDPOINTS.md).

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /auth/login` - –í—Ö–æ–¥
- `POST /auth/yandex` - OAuth —á–µ—Ä–µ–∑ Yandex
- `POST /auth/vk` - OAuth —á–µ—Ä–µ–∑ VK

### –¢–∞–π—Ç–ª—ã
- `GET /titles` - –°–ø–∏—Å–æ–∫ —Ç–∞–π—Ç–ª–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- `POST /titles` - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–π—Ç–ª–∞ (admin)
- `GET /titles/:id` - –ü–æ–ª—É—á–∏—Ç—å —Ç–∞–π—Ç–ª
- `PUT /titles/:id` - –û–±–Ω–æ–≤–∏—Ç—å —Ç–∞–π—Ç–ª (admin)

### –ì–ª–∞–≤—ã
- `POST /chapters/upload` - –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤—ã —Å —Ñ–∞–π–ª–∞–º–∏ (admin)
- `GET /chapters/title/:titleId` - –ì–ª–∞–≤—ã —Ç–∞–π—Ç–ª–∞
- `POST /chapters/:id/view` - –£–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä—ã

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `GET /users/profile` - –ü—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /users/profile/bookmarks` - –ó–∞–∫–ª–∞–¥–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /users/profile/bookmarks/:titleId` - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–ª–∞–¥–∫—É

## üìã –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã API

–í—Å–µ API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–ª–µ–¥—É—é—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º, –æ–ø–∏—Å–∞–Ω–Ω—ã–º –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º API](docs/api-standards.md).

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:
```json
{
  "success": true,
  "data": {},
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏",
  "timestamp": "2023-01-01T12:00:00.000Z",
  "path": "–ø—É—Ç—å/–∫/—ç–Ω–¥–ø–æ–∏–Ω—Ç—É",
  "method": "HTTP_METHOD"
}
```

## üèÉ‚Äç‚ôÇÔ∏è –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
   ```bash
   npm install
   ```

2. **–ó–∞–ø—É—Å–∫ MongoDB**
   ```bash
   docker-compose up -d
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:
   ```
   MONGO_LOGIN=admin
   MONGO_PASSWORD=password123
   MONGO_HOST=localhost
   MONGO_PORT=27017
   MONGO_AUTHDATABASE=admin
   JWT_SECRET=your-secret-key
   ```

4. **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
   ```bash
   npm run start:dev
   ```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ auth/          # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ users/         # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –ø—Ä–æ—Ñ–∏–ª–∏
‚îú‚îÄ‚îÄ titles/        # –¢–∞–π—Ç–ª—ã (–º–∞–Ω–≥–∞/–∫–æ–º–∏–∫—Å—ã)
‚îú‚îÄ‚îÄ chapters/      # –ì–ª–∞–≤—ã —Ç–∞–π—Ç–ª–æ–≤
‚îú‚îÄ‚îÄ collections/  # –ö–æ–ª–ª–µ–∫—Ü–∏–∏ —Ç–∞–π—Ç–ª–æ–≤
‚îú‚îÄ‚îÄ comments/      # –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
‚îú‚îÄ‚îÄ search/        # –ü–æ–∏—Å–∫
‚îú‚îÄ‚îÄ notifications/ # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ manga-parser/  # –ü–∞—Ä—Å–µ—Ä –º–∞–Ω–≥–∏ —Å –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
‚îú‚îÄ‚îÄ auto-parsing/  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥
‚îú‚îÄ‚îÄ common/        # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (interceptors, filters, dto)
‚îú‚îÄ‚îÄ files/         # –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
‚îú‚îÄ‚îÄ schemas/       # MongoDB —Å—Ö–µ–º—ã
‚îî‚îÄ‚îÄ config/        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ UNLICENSED - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –ø—Ä–æ–µ–∫—Ç–∞.